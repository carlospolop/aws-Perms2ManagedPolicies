import argparse
import requests
from typing import List, Dict, Set
from termcolor import colored


aws_bf_permissions_detectable = [
    "inspector:DescribeAssessmentTemplates",
	"elasticloadbalancing::DescribeAccountLimits",
	"amplifybackend:ListS3Buckets",
	"config:ListResourceEvaluations",
	"lightsail:GetDistributionBundles",
	"forecast:ListWhatIfForecastExports",
	"servicecatalog:ListAcceptedPortfolioShares",
	"resource-explorer-2:ListSupportedResourceTypes",
	"workspaces:DescribeWorkspaceImages",
	"appconfig:ListApplications",
	"servicecatalog:ListApplications",
	"iotanalytics:ListDatastores",
	"iot:ListOutgoingCertificates",
	"frauddetector:GetEntityTypes",
	"personalize:ListMetricAttributions",
	"pricing:DescribeServices",
	"glue:ListCrawlers",
	"inspector2:ListUsageTotals",
	"gamelift:DescribeEC2InstanceLimits",
	"chime:ListVoiceConnectorGroups",
	"memorydb:DescribeUsers",
	"imagebuilder:ListDistributionConfigurations",
	"networkmanager:DescribeGlobalNetworks",
	"emr-serverless:ListApplications",
	"personalize:ListSolutions",
	"ec2:DescribeHosts",
	"ssm:ListComplianceSummaries",
	"iot:GetIndexingConfiguration",
	"mq:DescribeBrokerEngineTypes",
	"waf:ListSqlInjectionMatchSets",
	"lightsail:GetDistributions",
	"accessanalyzer:ListPolicyGenerations",
	"ecs:ListClusters",
	"payment-cryptography:ListKeys",
	"cloudfront:ListPublicKeys",
	"entityresolution:ListMatchingWorkflows",
	"redshift:DescribeReservedNodeOfferings",
	"elasticmapreduce:ListClusters",
	"lex:GetMigrations",
	"imagebuilder:ListImageScanFindingAggregations",
	"sagemaker:ListEndpoints",
	"redshift:DescribeClusterVersions",
	"proton:ListEnvironmentTemplateVersions",
	"ec2:DescribeCoipPools",
	"glue:ListSchemas",
	"dms:DescribeOrderableReplicationInstances",
	"dms:DescribeMigrationProjects",
	"kafka:ListConfigurations",
	"greengrass:ListComponents",
	"ecs:ListTaskDefinitionFamilies",
	"clouddirectory:ListDevelopmentSchemaArns",
	"route53:ListHealthChecks",
	"codestar:ListProjects",
	"codebuild:ListCuratedEnvironmentImages",
	"gamelift:DescribeMatchmakingConfigurations",
	"ses:ListReceiptFilters",
	"payment-cryptography:ListAliases",
	"omics:ListSequenceStores",
	"waf-regional:ListSqlInjectionMatchSets",
	"dms:DescribeDataProviders",
	"comprehend:ListDocumentClassificationJobs",
	"compute-optimizer:GetEnrollmentStatus",
	"backup:ListBackupVaults",
	"sms-voice:DescribeAccountAttributes",
	"sagemaker:ListModels",
	"lambda:ListLayers",
	"frauddetector:DescribeModelVersions",
	"appstream:ListAssociatedStacks",
	"appsync:ListGraphqlApis",
	"backup:DescribeGlobalSettings",
	"cloudwatch:DescribeInsightRules",
	"elastic-inference:DescribeAcceleratorTypes",
	"ec2:GetVpnConnectionDeviceTypes",
	"athena:ListCapacityReservations",
	"refactor-spaces:ListEnvironments",
	"kafka:ListClustersV2",
	"iot:ListTunnels",
	"ec2:DescribeTransitGatewayConnects",
	"iam:ListVirtualMFADevices",
	"ssm:GetOpsSummary",
	"cloudformation:DescribeAccountLimits",
	"iot:ListNamedShadowsForThing",
	"codeploy:ListOnPremisesInstances",
	"omics:ListWorkflows",
	"panorama:ListNodeFromTemplateJobs",
	"iotfleethub:ListApplications",
	"sagemaker:ListWorkforces",
	"chime:ListAccounts",
	"kafka:GetCompatibleKafkaVersions",
	"forecast:ListPredictorBacktestExportJobs",
	"events:ListEndpoints",
	"mediaconnect:ListGateways",
	"inspector2:ListCoverage",
	"ssm:ListOpsItemEvents",
	"config:GetComplianceSummaryByResourceType",
	"greengrass:ListDeployments",
	"rds:DescribeBlueGreenDeployments",
	"dms:DescribeFleetAdvisorDatabases",
	"cassandra:Select",
	"iotevents:ListDetectorModels",
	"databrew:ListProjects",
	"iot:ListThingTypes",
	"elasticache:DescribeSnapshots",
	"codestar-notifications:ListEventTypes",
	"nimble:ListStudios",
	"route53resolver:ListFirewallRuleGroupAssociations",
	"codeploy:ListApplications",
	"healthlake:ListFHIRDatastores",
	"greengrass:ListCoreDevices",
	"cloudtrail:DescribeTrails",
	"codebuild:ListSharedProjects",
	"personalize:ListSchemas",
	"elastictranscoder:ListPipelines",
	"mobiletargeting:ListTemplates",
	"redshift:DescribeClusterTracks",
	"guardduty:ListInvitations",
	"signer:ListSigningProfiles",
	"transcribe:ListMedicalVocabularies",
	"servicecatalog:ListServiceActions",
	"autoscaling:DescribeScheduledActions",
	"chime:ListMediaPipelineKinesisVideoStreamPools",
	"private-networks:ListNetworks",
	"ses:GetSendQuota",
	"chime:ListVoiceConnectors",
	"ssm:ListCommandInvocations",
	"lex:ListTestSets",
	"proton:ListEnvironmentTemplates",
	"ec2:DescribeRegions",
	"snowball:ListJobs",
	"ses:ListReceiptRuleSets",
	"es:ListElasticsearchVersions",
	"ec2:DescribeVpcEndpointServices",
	"comprehend:ListPiiEntitiesDetectionJobs",
	"sns:ListTopics",
	"comprehend:ListEventsDetectionJobs",
	"forecast:ListDatasets",
	"elasticmapreduce:ListStudioSessionMappings",
	"tnb:ListSolNetworkPackages",
	"config:DescribeAggregationAuthorizations",
	"config:DescribeConfigurationRecorderStatus",
	"chime:GetVoiceConnectorLoggingConfiguration",
	"elasticache:DescribeUpdateActions",
	"shield:GetSubscriptionState",
	"lex:ListBots",
	"ec2:DescribeInstanceTypes",
	"synthetics:DescribeCanaries",
	"scheduler:ListSchedules",
	"autoscaling:DescribeAdjustmentTypes",
	"ec2:DescribeCapacityReservationFleets",
	"redshift:DescribeStorage",
	"waf:GetChangeToken",
	"omics:ListVariantImportJobs",
	"comprehendmedical:ListICD10CMInferenceJobs",
	"codeploy:ListGitHubAccountTokenNames",
	"rolesanywhere:ListSubjects",
	"gamelift:DescribeGameSessionQueues",
	"mq:ListBrokers",
	"dms:DescribeRecommendationLimitations",
	"databrew:ListJobs",
	"profile:ListDomains",
	"inspector:DescribeCrossAccountAccessRole",
	"geo:ListRouteCalculators",
	"directconnect:DescribeCustomerMetadata",
	"ses:GetIdentityDkimAttributes",
	"dms:DescribeEndpoints",
	"ses:ListEmailTemplates",
	"personalize:ListDatasetGroups",
	"iotanalytics:ListPipelines",
	"personalize:ListCampaigns",
	"transfer:ListSecurityPolicies",
	"rekognition:ListCollections",
	"connect:ListPhoneNumbersV2",
	"backup:ListRestoreJobs",
	"kafka:ListVpcConnections",
	"mgh:GetHomeRegion",
	"glue:GetClassifiers",
	"mediapackage-vod:ListPackagingGroups",
	"ssm-incidents:ListResponsePlans",
	"cleanrooms:ListMemberships",
	"inspector:DescribeRulesPackages",
	"cloudwatch:ListDashboards",
	"cognito-idp:DescribeUserPoolDomain",
	"dynamodb:ListContributorInsights",
	"frauddetector:GetModels",
	"ec2:DescribePlacementGroups",
	"detective:ListGraphs",
	"waf:ListRegexPatternSets",
	"dms:DescribePendingMaintenanceActions",
	"dms:DescribeReplications",
	"oam:ListLinks",
	"tnb:ListSolNetworkInstances",
	"signer:ListSigningJobs",
	"sdb:ListDomains",
	"config:DescribeDeliveryChannels",
	"ecr-public:DescribeRepositories",
	"ssm:DescribeMaintenanceWindows",
	"macie2:ListOrganizationAdminAccounts",
	"iotfleetwise:ListVehicles",
	"iot:ListRoleAliases",
	"elasticloadbalancing::DescribeLoadBalancers",
	"glue:GetMLTransforms",
	"ec2:DescribeNetworkInsightsPaths",
	"appconfig:ListExtensions",
	"rolesanywhere:ListTrustAnchors",
	"cloudfront:ListDistributionsByWebACLId",
	"storagegateway:ListTapes",
	"wellarchitected:ListNotifications",
	"glue:GetConnections",
	"ec2:DescribeFleets",
	"iotevents:ListAlarmModels",
	"ses:GetAccountSendingEnabled",
	"lookoutmetrics:ListAlerts",
	"ce:GetAnomalyMonitors",
	"ses:ListDedicatedIpPools",
	"medialive:ListInputSecurityGroups",
	"elasticmapreduce:ListSecurityConfigurations",
	"comprehend:ListDocumentClassifierSummaries",
	"migrationhub-orchestrator:ListPlugins",
	"sagemaker:ListInferenceRecommendationsJobs",
	"sagemaker:ListModelPackageGroups",
	"ssm-incidents:ListIncidentRecords",
	"lookoutequipment:ListInferenceExecutions",
	"sagemaker:ListExperiments",
	"personalize:ListSolutionVersions",
	"ec2:DescribeIpamScopes",
	"comprehend:ListEntityRecognizers",
	"lambda:ListFunctions",
	"mediapackage:ListChannels",
	"mobiletargeting:GetApps",
	"ec2:DescribeConversionTasks",
	"glue:ListMLTransforms",
	"sagemaker:ListFlowDefinitions",
	"datasync:ListLocations",
	"autoscaling:DescribeAutoScalingGroups",
	"lakeformation:ListTransactions",
	"iotwireless:GetEventConfigurationByResourceTypes",
	"cur:DescribeReportDefinitions",
	"iotfleetwise:GetLoggingOptions",
	"cloudwatch:DescribeAnomalyDetectors",
	"ssm:DescribePatchBaselines",
	"tag:GetTagValues",
	"workspaces:DescribeWorkspaceDirectories",
	"es:DescribePackages",
	"ec2:DescribeKeyPairs",
	"workspaces-web:ListUserSettings",
	"ram:GetResourceShareInvitations",
	"es:DescribeReservedElasticsearchInstanceOfferings",
	"kinesisvideo:GetDashStreamingSessionUrl",
	"migrationhub-strategy:ListImportFileTask",
	"appstream:DescribeDirectoryConfigs",
	"codeguru-security:ListScans",
	"appconfig:ListExtensionAssociations",
	"comprehend:ListDominantLanguageDetectionJobs",
	"iotwireless:ListWirelessGatewayTaskDefinitions",
	"kms:DescribeCustomKeyStores",
	"iotwireless:ListWirelessDevices",
	"events:ListRules",
	"mediapackage:ListHarvestJobs",
	"lex:GetBuiltinSlotTypes",
	"securityhub:ListOrganizationAdminAccounts",
	"proton:ListComponents",
	"account:GetContactInformation",
	"dms:DescribeEventCategories",
	"iotwireless:ListDestinations",
	"ses:GetIdentityPolicies",
	"ds:DescribeEventTopics",
	"ec2:DescribeLocalGatewayRouteTableVpcAssociations",
	"greengrass:ListEffectiveDeployments",
	"imagebuilder:ListImagePipelines",
	"sagemaker:ListInferenceExperiments",
	"iam:ListSAMLProviders",
	"personalize:ListBatchInferenceJobs",
	"s3-outposts:ListOutpostsWithS3",
	"kafka:ListReplicators",
	"textract:ListAdapters",
	"ecs:DescribeClusters",
	"cloudformation:ListResourceRequests",
	"dax:DescribeClusters",
	"batch:DescribeJobQueues",
	"fsx:DescribeBackups",
	"iotfleetwise:ListFleets",
	"sms-voice:DescribePhoneNumbers",
	"kafkaconnect:ListWorkerConfigurations",
	"lex:ListImports",
	"ec2:DescribePublicIpv4Pools",
	"redshift:DescribeClusterDBRevisions",
	"codeguru-security:GetAccountConfiguration",
	"config:ListStoredQueries",
	"storagegateway:DescribeTapeArchives",
	"elastic-inference:DescribeAccelerators",
	"dax:DescribeSubnetGroups",
	"elasticbeanstalk:DescribeApplications",
	"glue:ListRegistries",
	"memorydb:DescribeSnapshots",
	"redshift:DescribeClusterSnapshots",
	"ec2:DescribeSecurityGroups",
	"forecast:ListPredictors",
	"storagegateway:ListAutomaticTapeCreationPolicies",
	"backup-gateway:ListHypervisors",
	"es:DescribeInboundCrossClusterSearchConnections",
	"es:GetCompatibleVersions",
	"discovery:DescribeTags",
	"emr-containers:ListJobTemplates",
	"sagemaker:ListFeatureGroups",
	"ssm-contacts:ListContacts",
	"managedblockchain:ListInvitations",
	"snowball:GetSnowballUsage",
	"rds:DescribeGlobalClusters",
	"glue:GetResourcePolicies",
	"mediaconnect:ListBridges",
	"mgh:ListApplicationStates",
	"simspaceweaver:ListSimulations",
	"dms:DescribeInstanceProfiles",
	"iot:ListSecurityProfiles",
	"groundstation:ListConfigs",
	"ssm:DescribeInventoryDeletions",
	"backup:ListReportPlans",
	"states:ListActivities",
	"lookoutvision:ListProjects",
	"waf:ListRules",
	"accessanalyzer:ListAnalyzers",
	"medialive:ListMultiplexes",
	"lightsail:GetContainerAPIMetadata",
	"ds:ListLogSubscriptions",
	"ec2:DescribeInstanceConnectEndpoints",
	"dynamodb:DescribeEndpoints",
	"dms:DescribeFleetAdvisorLsaAnalysis",
	"storagegateway:ListTapePools",
	"redshift-serverless:ListNamespaces",
	"voiceid:ListDomains",
	"network-firewall:ListRuleGroups",
	"chime:ListSipRules",
	"elasticache:DescribeCacheParameterGroups",
	"xray:GetSamplingRules",
	"ec2:DescribeReservedInstances",
	"vpc-lattice:ListServices",
	"sagemaker:ListDomains",
	"dms:DescribeEndpointTypes",
	"codepipeline:ListPipelines",
	"omics:ListRunGroups",
	"comprehend:ListDocumentClassifiers",
	"forecast:ListDatasetImportJobs",
	"ec2:DescribeAddresses",
	"autoscaling:DescribeScalingActivities",
	"iot:ListJobTemplates",
	"sagemaker:ListLabelingJobs",
	"robomaker:ListSimulationJobs",
	"glue:GetDatabases",
	"databrew:ListRulesets",
	"clouddirectory:ListDirectories",
	"lightsail:GetInstanceSnapshots",
	"iotwireless:ListNetworkAnalyzerConfigurations",
	"sms-voice:DescribePools",
	"vpc-lattice:ListTargetGroups",
	"organizations:ListRoots",
	"route53:GetHostedZoneCount",
	"ssm:DescribePatchGroupState",
	"aoss:ListCollections",
	"ssm-contacts:ListEngagements",
	"transfer:ListWorkflows",
	"iot:GetPackageConfiguration",
	"ecr-public:DescribeRegistries",
	"iotwireless:ListFuotaTasks",
	"inspector:DescribeExclusions",
	"datasync:ListDiscoveryJobs",
	"profile:ListProfileObjectTypeTemplates",
	"rds:DescribeDBProxies",
	"cloudformation:ListTypes",
	"entityresolution:ListProviderServices",
	"organizations:ListAccounts",
	"redshift:DescribeScheduledActions",
	"forecast:ListWhatIfAnalyses",
	"directconnect:DescribeLags",
	"datasync:ListTaskExecutions",
	"glue:GetTriggers",
	"xray:ListResourcePolicies",
	"ec2:DescribeVpcPeeringConnections",
	"license-manager-linux-subscriptions:GetServiceSettings",
	"frauddetector:GetEventTypes",
	"greengrass:ListConnectorDefinitions",
	"events:ListArchives",
	"glue:ListDataQualityRulesets",
	"chime:ListPhoneNumberOrders",
	"backup:ListProtectedResources",
	"rds:DescribePendingMaintenanceActions",
	"cloudfront:ListOriginAccessControls",
	"events:ListConnections",
	"ce:ListCostCategoryDefinitions",
	"wellarchitected:ListLenses",
	"codebuild:ListReportGroups",
	"dms:DescribeCertificates",
	"connect-campaigns:ListCampaigns",
	"elasticbeanstalk:ListPlatformVersions",
	"iot:ListThingRegistrationTasks",
	"ec2:DescribeTrafficMirrorFilters",
	"signer:ListSigningPlatforms",
	"datasync:ListTasks",
	"appfabric:ListAppBundles",
	"dlm:GetLifecyclePolicies",
	"logs:DescribeQueries",
	"ec2:DescribeReservedInstancesModifications",
	"redshift-data:ListStatements",
	"comprehendmedical:ListEntitiesDetectionV2Jobs",
	"codebuild:ListProjects",
	"iot:ListJobs",
	"sagemaker:ListModelCardExportJobs",
	"textract:ListAdapterVersions",
	"wellarchitected:ListProfiles",
	"lightsail:GetCertificates",
	"cloudtrail:ListImports",
	"codestar:ListUserProfiles",
	"ec2:DescribeAggregateIdFormat",
	"ssm:ListCommands",
	"sagemaker:ListModelPackages",
	"waf:ListXssMatchSets",
	"ec2:DescribeTransitGatewayAttachments",
	"config:DescribeRetentionConfigurations",
	"ses:ListIdentities",
	"route53resolver:ListResolverQueryLogConfigAssociations",
	"sagemaker:ListSpaces",
	"iam:GetUser",
	"ec2:DescribeCustomerGateways",
	"rds:DescribeDBInstanceAutomatedBackups",
	"lightsail:GetDisks",
	"aws-marketplace:GetEntitlements",
	"lookoutmetrics:ListAnomalyDetectors",
	"sagemaker:ListCodeRepositories",
	"secretsmanager:GetRandomPassword",
	"codestar-notifications:ListNotificationRules",
	"lex:ListTestExecutions",
	"ec2:DescribeHostReservationOfferings",
	"ec2:DescribePrefixLists",
	"sagemaker:ListContexts",
	"lightsail:GetRegions",
	"rds:DescribeEvents",
	"databrew:ListRecipes",
	"sagemaker:ListResourceCatalogs",
	"apprunner:ListAutoScalingConfigurations",
	"ds:GetDirectoryLimits",
	"ram:ListResourceTypes",
	"lookoutequipment:ListModels",
	"forecast:ListForecasts",
	"elasticmapreduce:ListNotebookExecutions",
	"fsx:DescribeSnapshots",
	"wisdom:ListKnowledgeBases",
	"ec2:DescribeSubnets",
	"gamelift:DescribeMatchmakingRuleSets",
	"mediaconvert:ListQueues",
	"route53:ListGeoLocations",
	"iotwireless:GetLogLevelsByResourceTypes",
	"dms:DescribeReplicationTasks",
	"omics:ListReferenceStores",
	"es:DescribeInboundConnections",
	"lakeformation:ListLFTags",
	"lakeformation:ListTableStorageOptimizers",
	"glue:ListTriggers",
	"rds:DescribeDBParameterGroups",
	"iam:ListSSHPublicKeys",
	"discovery:ListServerNeighbors",
	"iam:ListServerCertificates",
	"ssm:GetInventory",
	"glue:GetUserDefinedFunctions",
	"tag:GetTagKeys",
	"sagemaker:ListUserProfiles",
	"batch:DescribeComputeEnvironments",
	"snowball:ListCompatibleImages",
	"ec2:DescribeExportTasks",
	"sagemaker:ListMonitoringSchedules",
	"es:DescribeReservedInstanceOfferings",
	"ssm:GetPatchBaselineForPatchGroup",
	"inspector:ListRulesPackages",
	"billingconductor:ListBillingGroupCostReports",
	"wellarchitected:ListReviewTemplates",
	"route53:ListHostedZones",
	"organizations:ListHandshakesForAccount",
	"inspector:ListEventSubscriptions",
	"robomaker:ListSimulationJobBatches",
	"forecast:ListDatasetGroups",
	"acm:ListCertificates",
	"frauddetector:GetOutcomes",
	"datazone:ListDomains",
	"codeartifact:ListRepositories",
	"fsx:DescribeVolumes",
	"glue:GetSecurityConfigurations",
	"lex:GetBotChannelAssociations",
	"iotevents:ListInputs",
	"ec2:DescribeVolumesModifications",
	"proton:ListServiceTemplateVersions",
	"config:DescribeConformancePacks",
	"translate:ListLanguages",
	"codeploy:ListDeploymentConfigs",
	"config:DescribeOrganizationConformancePacks",
	"ec2:DescribeVerifiedAccessGroups",
	"backup:ListBackupPlanTemplates",
	"ec2:DescribeNetworkInsightsAccessScopes",
	"migrationhub-strategy:GetPortfolioPreferences",
	"codecommit:ListApprovalRuleTemplates",
	"chime:ListMediaCapturePipelines",
	"panorama:ListPackages",
	"iotsitewise:DescribeStorageConfiguration",
	"cloudwatch:ListMetricStreams",
	"servicecatalog:ListPortfolios",
	"iot:ListAuditSuppressions",
	"organizations:ListDelegatedAdministrators",
	"sagemaker:ListNotebookInstances",
	"config:DescribeComplianceByConfigRule",
	"savingsplans:DescribeSavingsPlansOfferings",
	"memorydb:DescribeClusters",
	"ssm-incidents:ListReplicationSets",
	"ram:ListReplacePermissionAssociationsWork",
	"chime:GetPhoneNumberSettings",
	"iot:ListTopicRuleDestinations",
	"translate:ListTerminologies",
	"codepipeline:ListWebhooks",
	"comprehend:ListSentimentDetectionJobs",
	"kafkaconnect:ListConnectors",
	"dms:DescribeAccountAttributes",
	"sagemaker:ListTrialComponents",
	"ses:GetDedicatedIps",
	"dataexchange:ListJobs",
	"sms-voice:DescribeOptOutLists",
	"cloudfront:ListRealtimeLogConfigs",
	"servicequotas:ListRequestedServiceQuotaChangeHistory",
	"codebuild:ListBuilds",
	"config:DescribeConfigurationAggregators",
	"transfer:ListServers",
	"cloudwatch:ListMetrics",
	"elasticbeanstalk:ListAvailableSolutionStacks",
	"es:DescribeReservedElasticsearchInstances",
	"cognito-sync:ListIdentityPoolUsage",
	"ses:GetAccount",
	"redshift-serverless:ListWorkgroups",
	"frauddetector:ListEventPredictions",
	"redshift:DescribeDataSharesForProducer",
	"wellarchitected:ListWorkloads",
	"iotfleetwise:ListDecoderManifests",
	"mediatailor:ListPlaybackConfigurations",
	"waf-regional:ListRuleGroups",
	"apprunner:ListConnections",
	"timestream:ListScheduledQueries",
	"elasticmapreduce:ListStudios",
	"timestream:DescribeEndpoints",
	"tnb:ListSolFunctionPackages",
	"transcribe:ListMedicalTranscriptionJobs",
	"redshift:DescribeSnapshotCopyGrants",
	"ec2:DescribeNetworkInterfacePermissions",
	"appstream:DescribeImages",
	"appsync:ListDomainNames",
	"polly:DescribeVoices",
	"ec2:DescribeCarrierGateways",
	"lightsail:GetDomains",
	"frauddetector:GetExternalModels",
	"sagemaker:ListHumanTaskUis",
	"personalize:ListRecommenders",
	"medical-imaging:ListDatastores",
	"proton:ListServiceInstances",
	"fis:ListActions",
	"apprunner:ListVpcConnectors",
	"redshift:DescribeEvents",
	"ec2:DescribeVerifiedAccessTrustProviders",
	"glue:ListWorkflows",
	"ecs:DescribeCapacityProviders",
	"elasticmapreduce:ListReleaseLabels",
	"iotdeviceadvisor:GetEndpoint",
	"lex:GetSlotTypeVersions",
	"workspaces-web:ListTrustStores",
	"bedrock:GetModelInvocationLoggingConfiguration",
	"forecast:ListExplainabilityExports",
	"batch:DescribeJobs",
	"rds:DescribeDBEngineVersions",
	"robomaker:ListSimulationApplications",
	"discovery:DescribeImportTasks",
	"lightsail:GetRelationalDatabaseSnapshots",
	"iottwinmaker:ListSyncJobs",
	"comprehend:ListFlywheels",
	"gamelift:ListBuilds",
	"ec2:DescribeDhcpOptions",
	"panorama:ListPackageImportJobs",
	"kinesisvideo:GetIceServerConfig",
	"rolesanywhere:ListProfiles",
	"chime:ListAppInstances",
	"cloudsearch:ListDomainNames",
	"elasticache:DescribeReplicationGroups",
	"kinesisvideo:GetHlsStreamingSessionUrl",
	"detective:ListOrganizationAdminAccount",
	"macie2:GetInvitationsCount",
	"dataexchange:ListDataSets",
	"sagemaker:GetSagemakerServicecatalogPortfolioStatus",
	"resiliencehub:ListSuggestedResiliencyPolicies",
	"ssm:DescribeAutomationExecutions",
	"personalize:ListRecipes",
	"ec2:DescribeVpcEndpointConnections",
	"athena:ListWorkGroups",
	"discovery:GetDiscoverySummary",
	"sagemaker:ListHyperParameterTuningJobs",
	"rds:DescribeAccountAttributes",
	"ec2:DescribeAccountAttributes",
	"wellarchitected:ListProfileNotifications",
	"elasticloadbalancing:DescribeLoadBalancerPolicies",
	"organizations:ListCreateAccountStatus",
	"mediaconvert:GetPolicy",
	"groundstation:ListDataflowEndpointGroups",
	"robomaker:ListWorldGenerationJobs",
	"iot:ListThings",
	"waf:ListRateBasedRules",
	"redshift:DescribeClusterSubnetGroups",
	"transcribe:ListTranscriptionJobs",
	"athena:ListDataCatalogs",
	"iot:ListCACertificates",
	"sms-voice:DescribeAccountLimits",
	"iot:ListBillingGroups",
	"xray:GetSamplingStatisticSummaries",
	"fis:ListExperiments",
	"rekognition:ListStreamProcessors",
	"servicequotas:ListServices",
	"ses:GetBlacklistReports",
	"sns:GetSMSSandboxAccountStatus",
	"mediaconvert:DescribeEndpoints",
	"lightsail:GetBlueprints",
	"s3-outposts:ListEndpoints",
	"ecs:ListTaskDefinitions",
	"ivschat:ListLoggingConfigurations",
	"bedrock:ListFoundationModels",
	"groundstation:ListSatellites",
	"ec2:DescribeTransitGatewayRouteTables",
	"ec2:DescribeIamInstanceProfileAssociations",
	"lakeformation:ListDataCellsFilter",
	"apigateway:GET",
	"chime:ListVoiceProfileDomains",
	"gamelift:ListScripts",
	"sagemaker:ListStudioLifecycleConfigs",
	"waf-regional:ListByteMatchSets",
	"imagebuilder:ListInfrastructureConfigurations",
	"sagemaker:ListModelMetadata",
	"shield:ListAttacks",
	"devops-guru:DescribeAccountHealth",
	"qldb:ListJournalS3Exports",
	"lightsail:GetKeyPairs",
	"lookoutequipment:ListModelVersions",
	"memorydb:DescribeSubnetGroups",
	"ses:ListEmailIdentities",
	"autoscaling:DescribeNotificationConfigurations",
	"route53resolver:ListFirewallConfigs",
	"cloudfront:ListCloudFrontOriginAccessIdentities",
	"ce:ListSavingsPlansPurchaseRecommendationGeneration",
	"iotsitewise:ListPortals",
	"comprehend:ListTargetedSentimentDetectionJobs",
	"iot:GetRegistrationCode",
	"lakeformation:ListPermissions",
	"m2:ListApplications",
	"ses:ListDeliverabilityTestReports",
	"workspaces-web:ListBrowserSettings",
	"config:DescribeConformancePackStatus",
	"sns:ListPhoneNumbersOptedOut",
	"glue:GetDataCatalogEncryptionSettings",
	"appstream:DescribeFleets",
	"wellarchitected:ListShareInvitations",
	"ivs:ListStreams",
	"ssm:ListResourceDataSync",
	"elasticfilesystem:DescribeFileSystems",
	"apprunner:ListObservabilityConfigurations",
	"forecast:ListMonitors",
	"migrationhub-strategy:GetPortfolioSummary",
	"finspace:ListKxEnvironments",
	"backup:ListCopyJobs",
	"docdb-elastic:ListClusterSnapshots",
	"iam:ListAccessKeys",
	"wellarchitected:GetProfileTemplate",
	"config:GetComplianceSummaryByConfigRule",
	"waf:ListRuleGroups",
	"inspector2:ListFindings",
	"omics:ListAnnotationStores",
	"dynamodb:ListStreams",
	"snowball:ListClusters",
	"comprehend:ListKeyPhrasesDetectionJobs",
	"migrationhub-orchestrator:ListTemplates",
	"migrationhub-strategy:ListServers",
	"secretsmanager:ListSecrets",
	"directconnect:DescribeVirtualInterfaces",
	"config:DescribeConfigRules",
	"resource-groups:GetAccountSettings",
	"ec2:DescribeExportImageTasks",
	"ec2:DescribeIpamPools",
	"directconnect:DescribeVirtualGateways",
	"guardduty:ListDetectors",
	"elasticbeanstalk:ListPlatformBranches",
	"transcribe:ListCallAnalyticsJobs",
	"logs:DescribeDestinations",
	"elasticache:DescribeUserGroups",
	"app-integrations:ListDataIntegrationAssociations",
	"ec2:DescribeIpamResourceDiscoveries",
	"appstream:DescribeUsageReportSubscriptions",
	"aoss:ListVpcEndpoints",
	"route53domains:ListDomains",
	"lightsail:GetBuckets",
	"iotfleetwise:GetEncryptionConfiguration",
	"ec2:DescribeAwsNetworkPerformanceMetricSubscriptions",
	"organizations:ListHandshakesForOrganization",
	"dynamodb:ListExports",
	"mediapackage-vod:ListPackagingConfigurations",
	"panorama:ListDevices",
	"transcribe:ListLanguageModels",
	"tnb:ListSolFunctionInstances",
	"mgh:ListMigrationTasks",
	"ec2:DescribeVpcEndpointConnectionNotifications",
	"app-integrations:ListDataIntegrations",
	"config:DescribeConfigurationRecorders",
	"dynamodb:ListTables",
	"ses:GetIdentityMailFromDomainAttributes",
	"sagemaker:ListModelBiasJobDefinitions",
	"greengrass:ListBulkDeploymentDetailedReports",
	"autoscaling:DescribeLifecycleHookTypes",
	"detective:ListInvitations",
	"lex:GetIntents",
	"iotsitewise:ListBulkImportJobs",
	"cloudtrail:ListChannels",
	"ivs:ListPlaybackKeyPairs",
	"gamelift:ListLocations",
	"resource-explorer-2:ListIndexes",
	"ec2:DescribeInstanceEventWindows",
	"servicediscovery:ListServices",
	"comprehendmedical:ListSNOMEDCTInferenceJobs",
	"codeguru-profiler:GetFindingsReportAccountSummary",
	"ec2:DescribeVpcClassicLinkDnsSupport",
	"entityresolution:ListIdMappingWorkflows",
	"ec2:DescribeNetworkAcls",
	"lightsail:GetActiveNames",
	"sagemaker:ListWorkteams",
	"waf:ListByteMatchSets",
	"grafana:ListVersions",
	"connect:ListInstances",
	"inspector2:ListDelegatedAdminAccounts",
	"redshift:DescribeAuthenticationProfiles",
	"iot:DescribeEventConfigurations",
	"elasticache:DescribeReservedCacheNodesOfferings",
	"scheduler:ListScheduleGroups",
	"servicecatalog:GetConfiguration",
	"ssm:ListAssociations",
	"greengrass:ListBulkDeployments",
	"logs:DescribeResourcePolicies",
	"ec2:DescribeTrafficMirrorSessions",
	"ec2:DescribeNetworkInsightsAccessScopeAnalyses",
	"rds:DescribeOptionGroups",
	"waf:ListGeoMatchSets",
	"personalize:ListEventTrackers",
	"ses:GetSendStatistics",
	"ec2:DescribeSpotFleetRequests",
	"greengrass:ListClientDevicesAssociatedWithCoreDevice",
	"medialive:ListChannels",
	"robomaker:ListWorldTemplates",
	"autoscaling:DescribeMetricCollectionTypes",
	"ec2:DescribeImportImageTasks",
	"ec2:DescribeTransitGatewayConnectPeers",
	"rds:DescribeDBClusterEndpoints",
	"evidently:ListFeatures",
	"lambda:GetAccountSettings",
	"translate:ListParallelData",
	"waf-regional:ListGeoMatchSets",
	"sagemaker:ListMonitoringExecutions",
	"lightsail:GetContainerServices",
	"backup:ListReportJobs",
	"ssm:DescribeParameters",
	"iot:ListCustomMetrics",
	"storagegateway:ListVolumes",
	"lambda:ListEventSourceMappings",
	"iot:ListDimensions",
	"ec2:DescribeAvailabilityZones",
	"migrationhub-strategy:ListApplicationComponents",
	"lightsail:GetDiskSnapshots",
	"fsx:DescribeDataRepositoryAssociations",
	"redshift:DescribeEventCategories",
	"ssm:ListOpsMetadata",
	"appstream:DescribeImageBuilders",
	"config:DescribeDeliveryChannelStatus",
	"iotwireless:ListPartnerAccounts",
	"networkmanager:ListConnectPeers",
	"personalize:ListBatchSegmentJobs",
	"cloudhsm:DescribeClusters",
	"ecr-public:GetAuthorizationToken",
	"directconnect:DescribeDirectConnectGateways",
	"frauddetector:GetBatchPredictionJobs",
	"iam:ListGroups",
	"wisdom:ListAssistants",
	"iot:ListOTAUpdates",
	"iotdeviceadvisor:ListSuiteDefinitions",
	"sms-voice:DescribeSpendLimits",
	"elasticache:DescribeReservedCacheNodes",
	"ec2:DescribeVolumeStatus",
	"networkmanager:ListCoreNetworks",
	"lambda:ListLayerVersions",
	"lightsail:GetInstances",
	"glue:ListJobs",
	"ses:ListSuppressedDestinations",
	"mediastore:ListContainers",
	"imagebuilder:ListComponents",
	"comprehendmedical:ListRxNormInferenceJobs",
	"rds:DescribeDBSecurityGroups",
	"elasticbeanstalk:DescribeEvents",
	"guardduty:GetInvitationsCount",
	"waf-regional:ListIPSets",
	"ec2:DescribeIpv6Pools",
	"ce:GetAnomalySubscriptions",
	"events:ListEventSources",
	"pricing:GetAttributeValues",
	"mediaconnect:ListEntitlements",
	"ses:ListTemplates",
	"iot:ListJobExecutionsForThing",
	"app-integrations:ListEventIntegrationAssociations",
	"iam:ListSigningCertificates",
	"lightsail:GetRelationalDatabaseBlueprints",
	"ec2:DescribeIpams",
	"ssm:GetParameters",
	"schemas:ListRegistries",
	"kafkaconnect:ListCustomPlugins",
	"sso:ListInstances",
	"mediapackage:ListOriginEndpoints",
	"geo:ListKeys",
	"forecast:ListForecastExportJobs",
	"evidently:ListExperiments",
	"ec2:DescribeReplaceRootVolumeTasks",
	"comprehendmedical:ListPHIDetectionJobs",
	"ecr:DescribeRepositories",
	"ec2:DescribeNetworkInsightsAnalyses",
	"codeartifact:ListDomains",
	"ecr-public:GetLoginPassword",
	"vpc-lattice:ListServiceNetworks",
	"bedrock:ListProvisionedModelThroughputs",
	"resiliencehub:ListApps",
	"redshift:DescribeTags",
	"redshift:DescribeEventSubscriptions",
	"sagemaker:ListTransformJobs",
	"lakeformation:GetDataLakeSettings",
	"gamelift:ListFleets",
	"route53resolver:ListResolverQueryLogConfigs",
	"outposts:ListSites",
	"forecast:ListWhatIfForecasts",
	"route53:ListTrafficPolicies",
	"osis:ListPipelineBlueprints",
	"kinesis:DescribeLimits",
	"iotanalytics:ListDatasets",
	"synthetics:DescribeCanariesLastRun",
	"kendra-ranking:ListRescoreExecutionPlans",
	"lex:GetBots",
	"clouddirectory:ListManagedSchemaArns",
	"ec2:DescribeLocalGatewayRouteTableVirtualInterfaceGroupAssociations",
	"lightsail:GetStaticIps",
	"ssm:DescribeInstanceInformation",
	"rds:DescribeSourceRegions",
	"iam:GetAccountAuthorizationDetails",
	"polly:ListSpeechSynthesisTasks",
	"glue:ListDevEndpoints",
	"redshift:DescribeClusters",
	"ecr:GetAuthorizationToken",
	"mediaconvert:ListPresets",
	"rekognition:DescribeProjects",
	"supportapp:GetAccountAlias",
	"ec2:DescribeInternetGateways",
	"kendra:ListIndices",
	"elasticache:DescribeCacheClusters",
	"dms:DescribeReplicationSubnetGroups",
	"resource-groups:ListGroups",
	"dax:DescribeEvents",
	"ec2:ListImagesInRecycleBin",
	"ssm:GetConnectionStatus",
	"firehose:ListDeliveryStreams",
	"iam:ListPolicies",
	"greengrass:ListLoggerDefinitions",
	"storagegateway:ListFileSystemAssociations",
	"devops-guru:ListMonitoredResources",
	"transfer:ListConnectors",
	"lookoutmetrics:ListMetricSets",
	"proton:GetAccountSettings",
	"billingconductor:ListPricingPlans",
	"route53resolver:ListResolverRuleAssociations",
	"ec2:GetEbsEncryptionByDefault",
	"appstream:DescribeSessions",
	"fsx:DescribeDataRepositoryTasks",
	"lookoutequipment:ListRetrainingSchedulers",
	"route53resolver:ListFirewallDomainLists",
	"mediatailor:ListChannels",
	"resiliencehub:ListAppAssessments",
	"cloudtrail:ListTrails",
	"comprehend:ListEntityRecognizerSummaries",
	"frauddetector:GetLabels",
	"config:DescribeOrganizationConfigRuleStatuses",
	"codebuild:ListReports",
	"redshift:DescribeDataShares",
	"mediatailor:ListSourceLocations",
	"config:DescribeConfigRuleEvaluationStatus",
	"billingconductor:ListCustomLineItems",
	"dms:DescribeEvents",
	"ec2:DescribeTransitGatewayPolicyTables",
	"cloudfront:ListKeyGroups",
	"fis:ListExperimentTemplates",
	"inspector2:ListMembers",
	"cleanrooms:ListConfiguredTables",
	"robomaker:ListWorlds",
	"codestar-connections:ListConnections",
	"sagemaker:ListModelExplainabilityJobDefinitions",
	"cloudfront:ListCachePolicies",
	"fis:ListTargetResourceTypes",
	"profile:ListAccountIntegrations",
	"ec2:DescribeInstanceStatus",
	"iam:GetAccountSummary",
	"route53:GetGeoLocation",
	"rds:DescribeDBProxyEndpoints",
	"es:DescribeReservedInstances",
	"proton:ListEnvironments",
	"events:ListReplays",
	"servicecatalog:ListAttributeGroups",
	"directconnect:DescribeLocations",
	"sns:GetSMSAttributes",
	"iot:ListThingGroups",
	"es:ListVpcEndpoints",
	"mediaconvert:ListJobTemplates",
	"servicediscovery:ListNamespaces",
	"workspaces:DescribeConnectionAliases",
	"logs:DescribeQueryDefinitions",
	"lightsail:GetExportSnapshotRecords",
	"proton:ListServiceTemplates",
	"lex:GetIntentVersions",
	"dms:DescribeReplicationTaskIndividualAssessments",
	"databrew:ListSchedules",
	"rds:DescribeDBClusterAutomatedBackups",
	"inspector2:ListFilters",
	"directconnect:DescribeDirectConnectGatewayAssociationProposals",
	"servicecatalog:ListProvisionedProductPlans",
	"redshift:DescribeClusterParameterGroups",
	"elasticache:DescribeUsers",
	"pca-connector-ad:ListConnectors",
	"autoscaling:DescribeTags",
	"ec2:DescribeFastSnapshotRestores",
	"m2:ListEngineVersions",
	"sagemaker:ListLineageGroups",
	"aps:ListWorkspaces",
	"elasticache:DescribeEvents",
	"lex:GetBotAliases",
	"medialive:ListInputs",
	"sagemaker:ListEndpointConfigs",
	"backup:ListBackupPlans",
	"ivs:ListStages",
	"iottwinmaker:GetPricingPlan",
	"datasync:ListAgents",
	"ec2:DescribeTransitGatewayPeeringAttachments",
	"fsx:DescribeFileCaches",
	"es:DescribeOutboundCrossClusterSearchConnections",
	"cloudsearch:DescribeDomains",
	"memorydb:DescribeParameterGroups",
	"lightsail:GetBundles",
	"batch:DescribeJobDefinitions",
	"elasticache:DescribeGlobalReplicationGroups",
	"transfer:ListCertificates",
	"networkmanager:ListOrganizationServiceAccessStatus",
	"storagegateway:ListGateways",
	"lookoutequipment:ListDatasets",
	"lightsail:GetContactMethods",
	"organizations:DescribeOrganization",
	"personalize:ListDatasets",
	"cases:ListDomains",
	"sns:ListSMSSandboxPhoneNumbers",
	"backup-gateway:ListGateways",
	"internetmonitor:ListHealthEvents",
	"organizations:ListAWSServiceAccessForOrganization",
	"transcribe:ListVocabularyFilters",
	"ec2:DescribeAddressTransfers",
	"lightsail:GetLoadBalancers",
	"rds:DescribeReservedDBInstances",
	"ecr-public:GetRegistryCatalogData",
	"waf-regional:ListSizeConstraintSets",
	"cloudwatch:DescribeAlarms",
	"sagemaker:ListNotebookInstanceLifecycleConfigs",
	"backup:ListFrameworks",
	"greengrass:ListResourceDefinitions",
	"elasticfilesystem:DescribeAccessPoints",
	"timestream:ListDatabases",
	"securityhub:ListSecurityControlDefinitions",
	"ec2:DescribeInstanceTypeOfferings",
	"cloud9:DescribeEnvironmentMemberships",
	"cloudwatch:DescribeAlarmsForMetric",
	"backup:DescribeRegionSettings",
	"inspector:ListAssessmentRuns",
	"m2:ListEnvironments",
	"ses:ListConfigurationSets",
	"personalize:ListFilters",
	"workmail:ListOrganizations",
	"ecr:GetRegistryScanningConfiguration",
	"sagemaker:ListProcessingJobs",
	"iot:ListPackageVersions",
	"cloudformation:DescribeStacks",
	"fsx:DescribeFileSystems",
	"connect-campaigns:GetCampaignStateBatch",
	"gamelift:ListAliases",
	"es:ListDomainNames",
	"outposts:ListCatalogItems",
	"eks:DescribeAddonVersions",
	"waf-regional:GetChangeToken",
	"route53resolver:ListResolverRules",
	"ec2:DescribeInstanceCreditSpecifications",
	"imagebuilder:ListContainerRecipes",
	"route53resolver:ListOutpostResolvers",
	"elasticache:DescribeCacheEngineVersions",
	"es:GetCompatibleElasticsearchVersions",
	"elasticache:DescribeCacheSubnetGroups",
	"iot:ListCertificates",
	"logs:DescribeMetricFilters",
	"medialive:ListReservations",
	"waf:ListSubscribedRuleGroups",
	"rds:DescribeDBSnapshots",
	"workspaces:DescribeIpGroups",
	"codestar-connections:ListHosts",
	"lakeformation:ListResources",
	"iot:ListDomainConfigurations",
	"pipes:ListPipes",
	"iotwireless:ListMulticastGroups",
	"oam:ListSinks",
	"greengrass:ListDeviceDefinitions",
	"sagemaker:ListHubs",
	"autoscaling:DescribeAutoScalingNotificationTypes",
	"sagemaker:ListAlgorithms",
	"entityresolution:ListSchemaMappings",
	"ram:ListPermissions",
	"connect:ListTrafficDistributionGroups",
	"lookoutequipment:ListLabelGroups",
	"bedrock:ListModelCustomizationJobs",
	"chime:ListMediaInsightsPipelineConfigurations",
	"greengrass:ListCoreDefinitions",
	"kinesisanalytics:ListApplications",
	"datapipeline:ListPipelines",
	"dms:DescribeRecommendations",
	"ivs:ListRecordingConfigurations",
	"lightsail:GetCloudFormationStackRecords",
	"waf-regional:ListRegexMatchSets",
	"route53domains:ListPrices",
	"dms:DescribeEventSubscriptions",
	"airflow:ListEnvironments",
	"workspaces-web:ListPortals",
	"backup:ListLegalHolds",
	"geo:ListMaps",
	"ec2:DescribeAddressesAttribute",
	"autoscaling-plans:DescribeScalingPlans",
	"databrew:ListDatasets",
	"panorama:ListNodes",
	"redshift:DescribeDataSharesForConsumer",
	"ec2:DescribeLocalGatewayRouteTables",
	"iot:DescribeAccountAuditConfiguration",
	"mediaconnect:ListGatewayInstances",
	"ds:DescribeSnapshots",
	"ec2:ListSnapshotsInRecycleBin",
	"mediaconnect:ListFlows",
	"schemas:ListDiscoverers",
	"lightsail:GetLoadBalancerTlsPolicies",
	"workspaces:DescribeWorkspaces",
	"chime:ListSipMediaApplications",
	"ec2:DescribeFpgaImages",
	"app-integrations:ListEventIntegrations",
	"lex:GetBuiltinIntents",
	"memorydb:DescribeEngineVersions",
	"ssm:ListDocuments",
	"autoscaling:DescribeTerminationPolicyTypes",
	"greengrass:ListFunctionDefinitions",
	"inspector:DescribeResourceGroups",
	"proton:GetResourcesSummary",
	"iotanalytics:ListChannels",
	"ec2:GetImageBlockPublicAccessState",
	"directconnect:ListVirtualInterfaceTestHistory",
	"iotfleetwise:ListCampaigns",
	"iam:ListInstanceProfiles",
	"elasticache:DescribeServiceUpdates",
	"events:ListEventBuses",
	"polly:ListLexicons",
	"ecr:DescribeRegistry",
	"mgh:DescribeHomeRegionControls",
	"aoss:GetAccountSettings",
	"macie2:ListInvitations",
	"devops-guru:ListNotificationChannels",
	"app-integrations:ListApplications",
	"elasticloadbalancing:DescribeAccountLimits",
	"verifiedpermissions:ListPolicyStores",
	"billingconductor:ListBillingGroups",
	"workspaces-web:ListNetworkSettings",
	"athena:ListQueryExecutions",
	"migrationhub-orchestrator:ListWorkflows",
	"appmesh:ListMeshes",
	"lex:GetBotVersions",
	"memorydb:DescribeReservedNodes",
	"auditmanager:GetAccountStatus",
	"applicationinsights:ListProblems",
	"connect:ListDefaultVocabularies",
	"outposts:ListOrders",
	"appflow:ListFlows",
	"iam:ListUsers",
	"waf-regional:ListWebACLs",
	"iam:ListRoles",
	"sms-voice:DescribeSenderIds",
	"omics:ListRuns",
	"redshift-serverless:ListSnapshots",
	"ec2:DescribeSecurityGroupRules",
	"managedblockchain:ListAccessors",
	"grafana:ListWorkspaces",
	"inspector:ListFindings",
	"ec2:GetEbsDefaultKmsKeyId",
	"ec2:DescribeNetworkInterfaces",
	"proton:ListDeployments",
	"servicecatalog:GetAWSOrganizationsAccessStatus",
	"ssm:GetInventorySchema",
	"sagemaker:ListTrials",
	"tnb:ListSolNetworkOperations",
	"kinesisvideo:ListStreams",
	"workspaces:DescribeApplications",
	"config:ListDiscoveredResources",
	"ec2:DescribeVpcClassicLink",
	"billingconductor:ListAccountAssociations",
	"greengrass:ListInstalledComponents",
	"ssm:DescribeOpsItems",
	"sagemaker:ListImages",
	"lightsail:GetOperations",
	"waf-regional:ListRegexPatternSets",
	"resiliencehub:ListResiliencyPolicies",
	"lightsail:GetAlarms",
	"finspace:ListEnvironments",
	"iotfleetwise:ListSignalCatalogs",
	"lightsail:GetRelationalDatabaseBundles",
	"redshift:DescribeCustomDomainAssociations",
	"workspaces:DescribeWorkspacesConnectionStatus",
	"mobiletargeting:GetRecommenderConfigurations",
	"sts:GetCallerIdentity",
	"dms:DescribeApplicableIndividualAssessments",
	"ec2:DescribeTransitGateways",
	"elasticfilesystem:DescribeAccountPreferences",
	"cloudtrail:ListPublicKeys",
	"iot:ListActiveViolations",
	"ec2:DescribeVpnGateways",
	"glue:ListBlueprints",
	"evidently:ListProjects",
	"rum:ListAppMonitors",
	"medialive:DescribeAccountConfiguration",
	"emr-containers:ListVirtualClusters",
	"sagemaker:ListMonitoringAlertHistory",
	"codepipeline:ListActionTypes",
	"groundstation:ListMissionProfiles",
	"dax:DescribeParameterGroups",
	"glue:GetDevEndpoints",
	"savingsplans:DescribeSavingsPlansOfferingRates",
	"ds:DescribeDirectories",
	"greengrass:ListGroups",
	"sagemaker:ListApps",
	"sagemaker:ListAutoMLJobs",
	"inspector:DescribeAssessmentRuns",
	"elasticloadbalancing::DescribeTargetGroups",
	"kinesis:ListStreams",
	"panorama:ListApplicationInstances",
	"synthetics:ListGroups",
	"redshift-serverless:ListEndpointAccess",
	"iotsitewise:ListGateways",
	"migrationhub-strategy:ListCollectors",
	"greengrass:ListSubscriptionDefinitions",
	"iotsitewise:ListAssetModels",
	"gamelift:DescribeFleetCapacity",
	"ec2:DescribePrincipalIdFormat",
	"waf-regional:ListSubscribedRuleGroups",
	"lookoutequipment:ListLabels",
	"redshift:DescribeEndpointAccess",
	"sns:ListPlatformApplications",
	"ec2:DescribeManagedPrefixLists",
	"mq:DescribeBrokerInstanceOptions",
	"events:DescribeEventBus",
	"dms:DescribeFleetAdvisorSchemas",
	"sagemaker:ListProjects",
	"cloud9:ListEnvironments",
	"codeguru-reviewer:ListRepositoryAssociations",
	"route53resolver:ListFirewallRuleGroups",
	"arc-zonal-shift:ListManagedResources",
	"es:ListVersions",
	"elasticmapreduce:GetBlockPublicAccessConfiguration",
	"ec2:DescribeVpcEndpointServiceConfigurations",
	"sagemaker:ListPipelines",
	"acm:GetAccountConfiguration",
	"chime:GetMessagingSessionEndpoint",
	"comprehend:ListTopicsDetectionJobs",
	"dms:DescribeReplicationConfigs",
	"apprunner:ListVpcIngressConnections",
	"cloudfront:ListDistributions",
	"iot:ListPolicies",
	"iot:ListScheduledAudits",
	"batch:ListSchedulingPolicies",
	"backup:ListBackupJobs",
	"rds:DescribeEventSubscriptions",
	"sagemaker:ListAppImageConfigs",
	"dynamodb:ListImports",
	"iot:ListAuthorizers",
	"ec2:DescribeVerifiedAccessInstanceLoggingConfigurations",
	"iotwireless:ListWirelessDeviceImportTasks",
	"codeguru-profiler:ListProfilingGroups",
	"route53:ListTrafficPolicyInstances",
	"codestar-notifications:ListTargets",
	"comprehend:ListEndpoints",
	"redshift-serverless:ListUsageLimits",
	"iot:ListIndices",
	"ssm:DescribeActivations",
	"codeploy:ListDeployments",
	"workspaces-web:ListIpAccessSettings",
	"ses:DescribeActiveReceiptRuleSet",
	"config:DescribePendingAggregationRequests",
	"inspector2:ListCoverageStatistics",
	"imagebuilder:ListImageRecipes",
	"sagemaker:ListCompilationJobs",
	"waf:ListSizeConstraintSets",
	"rds:DescribeDBInstances",
	"route53:GetTrafficPolicyInstanceCount",
	"waf:ListWebACLs",
	"frauddetector:GetBatchImportJobs",
	"sagemaker:ListCandidatesForAutoMLJob",
	"lookoutequipment:ListInferenceSchedulers",
	"ec2:DescribeLocalGateways",
	"managedblockchain:ListNetworks",
	"servicequotas:ListServiceQuotaIncreaseRequestsInTemplate",
	"iam:ListMFADevices",
	"kafka:ListKafkaVersions",
	"mediaconnect:ListReservations",
	"sqs:ListQueues",
	"dms:DescribeConnections",
	"lightsail:GetContainerServicePowers",
	"redshift:DescribeOrderableClusterOptions",
	"supportapp:ListSlackChannelConfigurations",
	"networkmanager:ListAttachments",
	"lex:GetSlotTypes",
	"autoscaling:DescribeAutoScalingInstances",
	"fsx:DescribeStorageVirtualMachines",
	"omics:ListAnnotationImportJobs",
	"gamelift:ListGameServerGroups",
	"elasticloadbalancing::DescribeSslPolicies",
	"cloudfront:ListFunctions",
	"config:DescribeComplianceByResource",
	"waf-regional:ListRateBasedRules",
	"rds:DescribeDBSubnetGroups",
	"docdb-elastic:ListClusters",
	"sagemaker:ListModelQualityJobDefinitions",
	"mediapackage-vod:ListAssets",
	"glue:GetCatalogImportStatus",
	"ec2:DescribeEgressOnlyInternetGateways",
	"mediaconnect:ListOfferings",
	"mediapackagev2:ListChannelGroups",
	"redshift:DescribeAccountAttributes",
	"robomaker:ListWorldExportJobs",
	"ec2:DescribeBundleTasks",
	"sns:ListSubscriptions",
	"kafka:ListClusters",
	"dms:DescribeFleetAdvisorCollectors",
	"transfer:ListProfiles",
	"robomaker:ListRobotApplications",
	"sagemaker:ListModelCards",
	"dms:DescribeFleetAdvisorSchemaObjectSummary",
	"ec2:DescribeImportSnapshotTasks",
	"internetmonitor:ListMonitors",
	"synthetics:DescribeRuntimeVersions",
	"ec2:DescribeIdFormat",
	"gamelift:DescribeFleetAttributes",
	"athena:ListEngineVersions",
	"transcribe:ListVocabularies",
	"ses:ListContactLists",
	"ds:DescribeTrusts",
	"codecommit:ListRepositories",
	"shield:DescribeAttack",
	"autoscaling:DescribePolicies",
	"ivschat:ListRooms",
	"imagebuilder:ListImages",
	"iotwireless:ListWirelessGateways",
	"appconfig:ListDeploymentStrategies",
	"cloudfront:ListOriginRequestPolicies",
	"appstream:DescribeAppBlockBuilders",
	"elasticbeanstalk:DescribeAccountAttributes",
	"glue:ListDataQualityRuleRecommendationRuns",
	"ec2:DescribeTransitGatewayMulticastDomains",
	"ec2:DescribeVerifiedAccessEndpoints",
	"ec2:DescribeCapacityReservations",
	"ec2:DescribeStoreImageTasks",
	"clouddirectory:ListPublishedSchemaArns",
	"gamelift:DescribeVpcPeeringAuthorizations",
	"directconnect:DescribeConnections",
	"iot:ListMitigationActions",
	"rds:DescribeDBClusterSnapshots",
	"cloudfront:ListResponseHeadersPolicies",
	"iot:DescribeEndpoint",
	"cloudhsm:DescribeBackups",
	"resource-explorer-2:ListViews",
	"es:DescribeOutboundConnections",
	"redshift:DescribeHsmClientCertificates",
	"waf:ListIPSets",
	"cloudtrail:ListEventDataStores",
	"route53domains:ListOperations",
	"eks:ListClusters",
	"ssm-sap:ListComponents",
	"servicecatalog:ListRecordHistory",
	"route53:ListReusableDelegationSets",
	"appstream:ListAssociatedFleets",
	"ec2:DescribeTags",
	"chime:ListAvailableVoiceConnectorRegions",
	"dms:DescribeEngineVersions",
	"evidently:ListSegments",
	"aoss:GetPoliciesStats",
	"ram:ListPermissionAssociations",
	"sagemaker:ListSubscribedWorkteams",
	"cloudwatch:DescribeAlarmHistory",
	"devops-guru:ListRecommendations",
	"sms-voice:DescribeConfigurationSets",
	"cloudformation:ListExports",
	"networkmanager:ListPeerings",
	"xray:GetEncryptionConfig",
	"appflow:ListConnectors",
	"iot:ListTopicRules",
	"elasticloadbalancing:DescribeLoadBalancers",
	"ec2:DescribeVolumes",
	"redshift:DescribeUsageLimits",
	"inspector:ListAssessmentTemplates",
	"autoscaling:DescribeLifecycleHooks",
	"iotwireless:ListServiceProfiles",
	"iot:ListStreams",
	"frauddetector:GetKMSEncryptionKey",
	"redshift:DescribeHsmConfigurations",
	"elasticloadbalancing:DescribeLoadBalancerPolicyTypes",
	"sagemaker:ListArtifacts",
	"glue:ListCustomEntityTypes",
	"inspector:ListAssessmentTargets",
	"rds:DescribeDBClusterParameterGroups",
	"config:ListConformancePackComplianceScores",
	"dataexchange:ListEventActions",
	"tag:GetResources",
	"ecs:ListAccountSettings",
	"network-firewall:ListTLSInspectionConfigurations",
	"outposts:ListOutposts",
	"xray:GetGroups",
	"kms:ListKeys",
	"ec2:DescribeVpcEndpoints",
	"memorydb:DescribeServiceUpdates",
	"dms:DescribeReplicationTaskAssessmentRuns",
	"lightsail:GetRelationalDatabases",
	"frauddetector:GetVariables",
	"ec2:DescribeMovingAddresses",
	"waf:ListRegexMatchSets",
	"ec2:DescribeTransitGatewayRouteTableAnnouncements",
	"iotdeviceadvisor:ListSuiteRuns",
	"appflow:DescribeConnectorProfiles",
	"appstream:DescribeApplications",
	"dms:DescribeReplicationInstances",
	"dynamodb:ListGlobalTables",
	"inspector:DescribeFindings",
	"iam:ListAccountAliases",
	"ivs:ListChannels",
	"redshift:DescribeEndpointAuthorization",
	"dax:DescribeDefaultParameters",
	"inspector2:GetEc2DeepInspectionConfiguration",
	"network-firewall:ListFirewallPolicies",
	"sagemaker:ListTrainingJobs",
	"memorydb:DescribeAcls",
	"snowball:DescribeAddresses",
	"ecr:DescribePullThroughCacheRules",
	"config:GetStatus",
	"iotsitewise:ListTimeSeries",
	"waf-regional:ListXssMatchSets",
	"serverlessrepo:ListApplications",
	"chime:ListMediaPipelines",
	"cloudformation:ListStacks",
	"personalize:ListDatasetExportJobs",
	"glue:GetJobs",
	"codebuild:ListSourceCredentials",
	"athena:ListApplicationDPUSizes",
	"config:DescribeOrganizationConformancePackStatuses",
	"guardduty:ListOrganizationAdminAccounts",
	"lex:ListExports",
	"codebuild:ListBuildBatches",
	"iotwireless:GetServiceEndpoint",
	"pca-connector-ad:ListDirectoryRegistrations",
	"sagemaker:ListActions",
	"databrew:ListRecipeVersions",
	"glue:GetCrawlerMetrics",
	"medialive:ListInputDevices",
	"s3:ListAllMyBuckets",
	"glue:ListDataQualityResults",
	"iotsitewise:DescribeDefaultEncryptionConfiguration",
	"kinesisvideo:ListFragments",
	"sagemaker:ListDataQualityJobDefinitions",
	"cloudfront:ListFieldLevelEncryptionProfiles",
	"iam:ListServiceSpecificCredentials",
	"ec2:DescribeLocalGatewayVirtualInterfaces",
	"medialive:ListMultiplexPrograms",
	"ses:ListIdentityPolicies",
	"events:ListApiDestinations",
	"greengrass:GetGroupCertificateConfiguration",
	"config:DescribeOrganizationConfigRules",
	"ses:ListRecommendations",
	"appstream:DescribeStacks",
	"workspaces-web:ListUserAccessLoggingSettings",
	"redshift:DescribeSnapshotSchedules",
	"ec2:DescribeVpnConnections",
	"ssm-sap:ListDatabases",
	"states:ListStateMachines",
	"amplify:ListApps",
	"glue:GetCrawlers",
	"lambda:ListCodeSigningConfigs",
	"appstream:DescribeAppBlocks",
	"redshift-serverless:ListRecoveryPoints",
	"cleanrooms:ListCollaborations",
	"ec2:DescribeInstanceEventNotificationAttributes",
	"memorydb:DescribeEvents",
	"discovery:DescribeContinuousExports",
	"inspector2:ListAccountPermissions",
	"apprunner:ListServices",
	"sts:GetSessionToken",
	"iottwinmaker:ListWorkspaces",
	"ec2:DescribeRouteTables",
	"frauddetector:GetDetectors",
	"rds:DescribeEventCategories",
	"ec2:DescribeIpamResourceDiscoveryAssociations",
	"memorydb:DescribeReservedNodesOfferings",
	"timestream:ListBatchLoadTasks",
	"workspaces:DescribeWorkspaceBundles",
	"codebuild:ListSharedReportGroups",
	"route53resolver:ListResolverEndpoints",
	"chime:ListPhoneNumbers",
	"discovery:DescribeExportTasks",
	"discovery:DescribeAgents",
	"iotfleetwise:ListModelManifests",
	"ec2:DescribeHostReservations",
	"ssm:DescribePatchGroups",
	"cloudfront:ListContinuousDeploymentPolicies",
	"rds:DescribeCertificates",
	"ssm-sap:ListApplications",
	"comprehend:ListEntitiesDetectionJobs",
	"translate:ListTextTranslationJobs",
	"supportapp:ListSlackWorkspaceConfigurations",
	"ec2:DescribeFastLaunchImages",
	"network-firewall:ListFirewalls",
	"route53:ListQueryLoggingConfigs",
	"ses:ListCustomVerificationEmailTemplates",
	"ses:GetDeliverabilityDashboardOptions",
	"osis:ListPipelines",
	"ec2:DescribeNatGateways",
	"billingconductor:ListPricingRules",
	"ssm:DescribeInstancePatchStatesForPatchGroup",
	"iotsitewise:DescribeLoggingOptions",
	"glue:ListDataQualityRulesetEvaluationRuns",
	"m2:GetSignedBluinsightsUrl",
	"mgh:ListProgressUpdateStreams",
	"autoscaling:DescribeLaunchConfigurations",
	"gamelift:DescribeFleetUtilization",
	"ec2:GetSerialConsoleAccessStatus",
	"geo:ListGeofenceCollections",
	"personalize:ListDatasetImportJobs",
	"cloudfront:ListFieldLevelEncryptionConfigs",
	"route53resolver:GetOutpostResolver",
	"route53:ListHostedZonesByName",
	"cloudfront:ListStreamingDistributions",
	"elastictranscoder:ListPresets",
	"frauddetector:GetListsMetadata",
	"imagebuilder:ListImageScanFindings",
	"iot:ListPackages",
	"lookoutequipment:ListDataIngestionJobs",
	"route53:ListCidrCollections",
	"rds:DescribeDBClusters",
	"ssm:GetDefaultPatchBaseline",
	"mediaconvert:ListJobs",
	"ec2:DescribeTransitGatewayVpcAttachments",
	"ec2:DescribeScheduledInstances",
	"iot:ListManagedJobTemplates",
	"redshift:DescribeReservedNodes",
	"geo:ListTrackers",
	"iot:ListFleetMetrics",
	"applicationinsights:ListApplications",
	"proton:ListRepositories",
	"elasticbeanstalk:DescribeEnvironments",
	"ses:ListExportJobs",
	"shield:DescribeAttackStatistics",
	"logs:DescribeLogGroups",
	"glue:ListSessions",
	"qldb:ListLedgers",
	"panorama:ListDevicesJobs",
	"backup:GetSupportedResourceTypes",
	"kms:ListAliases",
	"rolesanywhere:ListCrls",
	"logs:DescribeExportTasks",
	"autoscaling:DescribeAccountLimits",
	"mq:ListConfigurations",
	"securityhub:DescribeStandards",
	"geo:ListPlaceIndexes",
	"ec2:DescribeSpotInstanceRequests",
	"iotwireless:ListDeviceProfiles",
	"ec2:DescribeFlowLogs",
	"bedrock:ListCustomModels",
	"snowball:ListLongTermPricing",
	"pricing:GetProducts",
	"dynamodb:ListBackups",
	"ec2:DescribeVerifiedAccessInstances",
	"route53:GetCheckerIpRanges",
	"config:GetDiscoveredResourceCounts",
	"autoscaling:DescribeScalingProcessTypes",
	"route53resolver:ListResolverConfigs",
	"evidently:ListLaunches",
	"iot:ListRetainedMessages",
	"proton:ListServices",
	"ses:GetIdentityNotificationAttributes",
	"servicediscovery:ListOperations",
	"dynamodb:DescribeLimits",
	"ec2:DescribeClassicLinkInstances",
	"athena:ListNamedQueries",
	"ec2:DescribeVpcs",
	"ec2:DescribeInstances",
	"lightsail:GetBucketBundles",
	"route53resolver:ListResolverDnssecConfigs",
	"iot:ListProvisioningTemplates",
	"ssm:ListResourceComplianceSummaries",
	"proton:GetServiceSyncBlockerSummary",
	"acm-pca:ListCertificateAuthorities",
	"arc-zonal-shift:ListZonalShifts",
	"forecast:ListExplainabilities",
	"storagegateway:ListFileShares",
	"savingsplans:DescribeSavingsPlans",
	"ec2:DescribeSnapshotTierStatus",
	"inspector:DescribeAssessmentTargets",
	"ec2:DescribeTrafficMirrorTargets",
	"cloudformation:ListStackSets",
	"groundstation:ListGroundStations",
	"cloudformation:DescribeOrganizationsAccess",
	"chime:GetGlobalSettings",
	"timestream:ListTables",
	"medialive:ListOfferings",
	"gamelift:DescribeVpcPeeringConnections",
	"ec2:DescribeLocalGatewayVirtualInterfaceGroups",
	"ec2:DescribeLaunchTemplates",
	"ce:ListCostAllocationTags",
	"route53:GetHealthCheckCount",
	"rds:DescribeExportTasks",
	"waf-regional:ListRules",
	"elasticbeanstalk:DescribeApplicationVersions",
	"ses:GetIdentityVerificationAttributes",
	"sts:GetFederationToken",
	"datasync:ListStorageSystems",
	"iot:GetBehaviorModelTrainingSummaries",
	"account:ListRegions",
	"kinesisvideo:ListSignalingChannels",
	"appflow:DescribeConnectors",
	"config:DescribeRemediationConfigurations",
	"iam:ListOpenIDConnectProviders",
	"sns:ListOriginationNumbers",
	"ec2:DescribeClientVpnEndpoints",
	"transcribe:ListCallAnalyticsCategories",
	"backup-gateway:ListVirtualMachines",
	"proton:GetServiceInstanceSyncStatus",
]


### START ###


def load_permissions_from_file(file_path: str) -> Set[str]:
    """Load permissions from a file, one per line."""
    with open(file_path, "r") as file:
        permissions = {line.strip() for line in file.readlines()}
    return permissions

def fetch_managed_policies(url: str) -> List[Dict]:
    """Fetch managed policies from a JSON URL."""
    response = requests.get(url)
    if response.status_code == 200:
        policies = response.json().get("policies", [])
        return policies
    else:
        raise Exception(f"Failed to fetch data: HTTP {response.status_code}")

def any_other_permissions(all_permissions: List[Dict], required_permissions: Set[str]) -> bool:
    """Check if other permissions not owned are in the policy."""

    all_permissions_tmp = all_permissions.copy()
    for p in required_permissions:
        if p in all_permissions_tmp:
            all_permissions_tmp.remove(p)
    
    for p in aws_bf_permissions_detectable:
        if p in all_permissions_tmp:
            return True
    
    return False
    

def generate_policy_combinations(policies: List[Dict], required_permissions: Set[str], check_bf_perms: bool) -> List[Set[str]]:
    policy_actions = {policy['arn']: set(policy['effective_action_names']) for policy in policies if 'arn' in policy and 'effective_action_names' in policy}
    valid_combinations = []       
    lonely_combinations = []

    for arn1, actions1 in policy_actions.items():
        if required_permissions.issubset(actions1):
            if check_bf_perms and any_other_permissions(actions1, required_permissions):
                continue
            else:
                valid_combinations.append({arn1})
                lonely_combinations.append(arn1)

    # Build combinations of up to 3 policies
    for arn1, actions1 in policy_actions.items():
        if not arn1 or arn1 in lonely_combinations:
            continue
        
        # Remove gathered permissions or continue if no permissions were removed
        prev_required_permissions_len = len(required_permissions)
        for a in actions1:
            if a in required_permissions:
                required_permissions.remove(a)
        if prev_required_permissions_len == len(required_permissions):
            continue
        
        if check_bf_perms and any_other_permissions(actions1, required_permissions):
                continue
        
        # Check with a second policy
        for arn2, actions2 in policy_actions.items():
            if arn2 and arn1 != arn2 and arn2 not in lonely_combinations:
                if check_bf_perms and any_other_permissions(actions2, required_permissions):
                    continue

                combined_actions = actions1 | actions2
                if required_permissions.issubset(combined_actions):
                    valid_combinations.append({arn1, arn2})
                    continue
                
                # Remove gathered permissions or continue if no permissions were removed
                prev_required_permissions_len = len(required_permissions)
                for a in actions2:
                    if a in required_permissions:
                        required_permissions.remove(a)
                if prev_required_permissions_len == len(required_permissions):
                    continue

                # Check with a third policy
                for arn3, actions3 in policy_actions.items():
                    if check_bf_perms and any_other_permissions(actions3, required_permissions):
                        continue
                    if arn3 and arn3 != arn1 and arn3 != arn2 and arn3 not in lonely_combinations:
                        full_combined_actions = combined_actions | actions3
                        if required_permissions.issubset(full_combined_actions):
                            valid_combinations.append({arn1, arn2, arn3})

    return valid_combinations

def main(permissions_file: str, check_bf_perms: bool):
    required_permissions = load_permissions_from_file(permissions_file)
    policies = fetch_managed_policies("https://raw.githubusercontent.com/iann0036/iam-dataset/main/aws/managed_policies.json")
    valid_combinations = generate_policy_combinations(policies, required_permissions, check_bf_perms)

    print(colored("\nOptimal combinations of AWS managed policies:", "green"))
    for combo in valid_combinations:
        print(colored(f"- {', '.join(combo)}", "green"))

if __name__ == "__main__":
    parser = argparse.ArgumentParser(description="Find combinations of AWS managed policies that together match a list of allowed permissions.")
    parser.add_argument("--permissions-file", type=str, required=True, help="Path to the file containing allowed permissions, one per line")
    parser.add_argument("--check-bf-perms", default=False, action="store_true", help="Try to remove false possitives by removed combinations that require you to have other permissions if you have used the tool https://github.com/carlospolop/bf-aws-permissions")
    args = parser.parse_args()
    main(permissions_file=args.permissions_file, check_bf_perms=args.check_bf_perms)







